<!DOCTYPE html>
<html>
  <head>
    <title>Notetaker</title>
    <link rel="icon" type="image/png" href="icon.png" />
    <link rel="stylesheet" type="text/css" href="stylesheet.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
        $("#generateBtn").click(function () {
          generateNotes();
        });

        function generateNotes() {
          // Get input data based on the selected input type
          var inputType = $("input[name='inputType']:checked").val();
          var inputData;

          if (inputType === "textInput") {
            inputData = $("#noteInput").val();
          } else {
            // Check if a file is selected
            var fileInput = $("#fileUpload")[0];
            var file = fileInput.files[0];

            if (!file) {
              // If no file is selected, proceed with text input
              inputData = $("#noteInput").val();
            } else {
              // Read the contents of the selected file
              var reader = new FileReader();
              reader.onload = function (e) {
                inputData = e.target.result;

                // Send data to the backend
                sendToBackend(inputType, inputData);
              };
              reader.readAsText(file);

              return;
            }
          }

          // Send data to the backend
          sendToBackend(inputType, inputData);
        }

        function sendToBackend(inputType, inputData) {
          $.ajax({
            type: "POST",
            url: "http://127.0.0.1:8888/generate_notes",
            contentType: "application/json",
            data: JSON.stringify({
              inputType: inputType,
              inputData: inputData,
            }),
            success: function (response) {
              // Display the generated notes
              $("#outputTextarea").val(response.notes);
              $("#outputDiv").show();
            },
            error: function (error) {
              console.error("Error:", error);
            },
          });
        }
      });
    </script>
  </head>
  <body>
    <h1>Note Taker</h1>

    <div>
      <input type="radio" id="textInput" name="inputType" value="textInput" checked />
      <label for="textInput">Text Input</label>
      <input type="text" id="noteInput" placeholder="Enter your notes here" />
    </div>

    <div>
      <input type="radio" id="fileInput" name="inputType" value="fileInput" />
      <label for="fileInput">Upload File</label>
      <input type="file" id="fileUpload" />
    </div>

    <button id="generateBtn">Generate Notes</button>

    <div id="outputDiv" style="display: none">
      <h2>Generated Notes</h2>
      <textarea id="outputTextarea" readonly></textarea>
    </div>
  </body>
</html>